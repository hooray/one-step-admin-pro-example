
/**
 * 由 One-step-admin 提供技术支持
 * Powered by One-step-admin
 * https://one-step-admin.hurui.me
 */
    
import{e as N,m as g,n as j,f as q,r,o as p,c as u,a as t,w as f,h as w,z as c,d as a,L as v,A as R,u as h,B as A,y as _,E as y,_ as L}from"./index-mFYeOg6f.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"upload-container"},D={key:1,class:"image"},T={class:"mask"},F={class:"actions"},G={key:0,class:"el-upload__tip"},H={style:{display:"inline-block"}},J=N({name:"ImageUpload",__name:"index",props:g({action:{},headers:{},data:{},name:{default:"file"},size:{default:2},width:{default:150},height:{default:150},placeholder:{default:""},notip:{type:Boolean,default:!1},ext:{default:()=>["jpg","png","gif","bmp"]},httpRequest:{}},{modelValue:{default:""},modelModifiers:{}}),emits:g(["onSuccess"],["update:modelValue"]),setup(m,{emit:$}){const d=m,V=$,i=j(m,"modelValue"),s=q({imageViewerVisible:!1,progress:{preview:"",percent:0}});function E(){s.value.imageViewerVisible=!0}function k(){s.value.imageViewerVisible=!1}function b(){i.value=""}const z=e=>{const l=e.name.split(".").at(-1)??"",o=d.ext.includes(l),n=e.size/1024/1024<d.size;return o||y.error(`上传图片只支持 ${d.ext.join(" / ")} 格式！`),n||y.error(`上传图片大小不能超过 ${d.size}MB！`),o&&n&&(s.value.progress.preview=URL.createObjectURL(e)),o&&n},B=e=>{s.value.progress.percent=~~e.percent},C=e=>{s.value.progress.preview="",s.value.progress.percent=0,V("onSuccess",e)};return(e,M)=>{const l=L,o=r("ElImage"),n=r("ElProgress"),I=r("ElUpload"),S=r("ElAlert"),U=r("ElImageViewer");return p(),u("div",P,[t(I,{"show-file-list":!1,headers:e.headers,action:e.action,data:e.data,name:e.name,"before-upload":z,"on-progress":B,"on-success":C,"http-request":e.httpRequest,drag:"",class:"image-upload"},{default:f(()=>[i.value===""?(p(),w(o,{key:0,src:i.value===""?e.placeholder:i.value,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},{error:f(()=>[a("div",{class:"image-slot",style:c(`width:${e.width}px;height:${e.height}px;`)},[t(l,{name:"i-ep:plus",class:"icon"})],4)]),_:1},8,["src","style"])):(p(),u("div",D,[t(o,{src:i.value,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),a("div",T,[a("div",F,[a("span",{title:"预览",onClick:v(E,["stop"])},[t(l,{name:"i-ep:zoom-in",class:"icon"})]),a("span",{title:"移除",onClick:v(b,["stop"])},[t(l,{name:"i-ep:delete",class:"icon"})])])])])),R(a("div",{class:"progress",style:c(`width:${e.width}px;height:${e.height}px;`)},[t(o,{src:h(s).progress.preview,style:c(`width:${e.width}px;height:${e.height}px;`),fit:"fill"},null,8,["src","style"]),t(n,{type:"circle",width:Math.min(e.width,e.height)*.8,percentage:h(s).progress.percent},null,8,["width","percentage"])],4),[[A,i.value===""&&h(s).progress.percent]])]),_:1},8,["headers","action","data","name","http-request"]),e.notip?_("",!0):(p(),u("div",G,[a("div",H,[t(S,{title:`上传图片支持 ${e.ext.join(" / ")} 格式，且图片大小不超过 ${e.size}MB，建议图片尺寸为 ${e.width}*${e.height}`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),h(s).imageViewerVisible?(p(),w(U,{key:1,"url-list":[i.value],teleported:"",onClose:k},null,8,["url-list"])):_("",!0)])}}}),W=O(J,[["__scopeId","data-v-4d6a6383"]]);export{W as _};
