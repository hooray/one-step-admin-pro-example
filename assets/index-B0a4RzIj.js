
/**
 * 由 One-step-admin 提供技术支持
 * Powered by One-step-admin
 * https://one-step-admin.hurui.me
 */
    
import{_ as re}from"./index.vue_vue_type_script_setup_true_lang-ChZ28WVx.js";import{_ as me}from"./index.vue_vue_type_script_setup_true_lang-DjF5febJ.js";import{aF as S,e as A,m as q,n as ee,f as T,r as p,o as f,c as h,A as j,B as Q,h as b,w as e,d as W,a as l,b as m,y as $,F as K,g as O,t as z,u as t,ar as N,E as G,D as le,G as te,W as oe,p as pe,s as X,aG as fe,aH as Y,_ as ce}from"./index-mFYeOg6f.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang-Cvjk0nJl.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as ge}from"./usePagination-Bo0a2Msc.js";const P={list:v=>S.get("delivery/list",{params:v,baseURL:"/mock/"}),detail:v=>S.get("delivery/detail",{params:{id:v},baseURL:"/mock/"}),create:v=>S.post("delivery/create",v,{baseURL:"/mock/"}),edit:v=>S.post("delivery/edit",v,{baseURL:"/mock/"}),delete:v=>S.post("delivery/delete",{id:v},{baseURL:"/mock/"}),changeStatus:v=>S.post("delivery/change/status",v,{baseURL:"/mock/"})},ve={key:0},ye={key:0},be={key:0},ke={key:0},Ve={key:0},Ee={key:0,style:{padding:"10px"}},Ce=A({__name:"index",props:q({type:{default:1},readonly:{type:Boolean,default:!1}},{modelValue:{default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(v){const g=ee(v,"modelValue"),c=T({index:"",visible:!1,checkList:[],disableList:[]});function x(){c.value.index="",c.value.checkList=[],c.value.disableList=o(),c.value.visible=!0}function L(){c.value.checkList.length===0?G({message:"请勾选区域",type:"warning"}):(c.value.index!==""?g.value[c.value.index].list=c.value.checkList:g.value.push({list:c.value.checkList,first_step:"",first_price:"",continued_step:"",continued_price:""}),c.value.visible=!1)}function n(a){c.value.index=a,c.value.checkList=g.value[a].list,c.value.disableList=o(a),c.value.visible=!0}function u(a){g.value.splice(a,1)}function k(a,s){g.value[a].list.splice(g.value[a].list.indexOf(s),1),g.value[a].list.length===0&&g.value.splice(a,1)}function E(a){let s="";for(const V in N)N[V].code===a&&(s=N[V].name);return s}function o(a){const s=[];for(let V=0;V<g.value.length;V++)a!==V&&s.push(...g.value[V].list);return s}return(a,s)=>{const V=p("ElTag"),U=p("ElCol"),C=p("ElButton"),r=p("ElRow"),i=p("ElTableColumn"),R=p("ElInput"),M=p("ElTable"),D=p("ElCheckbox"),_=p("ElCheckboxGroup"),H=p("ElDialog");return f(),h("div",null,[a.readonly&&g.value.length===0?$("",!0):j((f(),b(M,{key:0,data:g.value,border:"",class:"freight"},{empty:e(()=>s[4]||(s[4]=[W("span",null,null,-1)])),append:e(()=>[a.readonly?$("",!0):(f(),h("div",Ee,[l(C,{type:"primary",size:"small",plain:"",style:{width:"100%"},onClick:x},{default:e(()=>s[5]||(s[5]=[m(" 新增一条运费模版 ")])),_:1})]))]),default:e(()=>[l(i,{label:"运送到"},{default:e(d=>[a.readonly?(f(),h("div",ve,[(f(!0),h(K,null,O(d.row.list,(y,B)=>(f(),b(V,{key:B,type:"info"},{default:e(()=>[m(z(E(y)),1)]),_:2},1024))),128))])):(f(),b(r,{key:1,type:"flex",align:"middle",justify:"space-between"},{default:e(()=>[l(U,null,{default:e(()=>[(f(!0),h(K,null,O(d.row.list,(y,B)=>(f(),b(V,{key:B,"disable-transitions":!0,type:"info",closable:"",onClose:F=>k(d.$index,y)},{default:e(()=>[m(z(E(y)),1)]),_:2},1032,["onClose"]))),128))]),_:2},1024),l(U,{style:{width:"100px","text-align":"right"}},{default:e(()=>[l(C,{size:"small",plain:"",onClick:y=>n(d.$index)},{default:e(()=>s[2]||(s[2]=[m(" 编 辑 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))]),_:1}),l(i,{label:a.type===1?"首件数（件）":"首重量（kg）",width:"150",align:"center"},{default:e(d=>[a.readonly?(f(),h("span",ye,z(d.row.first_step),1)):(f(),b(R,{key:1,modelValue:d.row.first_step,"onUpdate:modelValue":y=>d.row.first_step=y,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1},8,["label"]),l(i,{label:"首费（元）",width:"150",align:"center"},{default:e(d=>[a.readonly?(f(),h("span",be,z(d.row.first_price),1)):(f(),b(R,{key:1,modelValue:d.row.first_price,"onUpdate:modelValue":y=>d.row.first_price=y,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),l(i,{label:a.type===1?"续件数（件）":"续重量（kg）",width:"150",align:"center"},{default:e(d=>[a.readonly?(f(),h("span",ke,z(d.row.continued_step),1)):(f(),b(R,{key:1,modelValue:d.row.continued_step,"onUpdate:modelValue":y=>d.row.continued_step=y,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1},8,["label"]),l(i,{label:"续费（元）",width:"150",align:"center"},{default:e(d=>[a.readonly?(f(),h("span",Ve,z(d.row.continued_price),1)):(f(),b(R,{key:1,modelValue:d.row.continued_price,"onUpdate:modelValue":y=>d.row.continued_price=y,size:"small"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1}),a.readonly?$("",!0):(f(),b(i,{key:0,label:"操作",width:"100",align:"center"},{default:e(d=>[l(C,{type:"danger",size:"small",plain:"",onClick:y=>u(d.$index)},{default:e(()=>s[3]||(s[3]=[m(" 删 除 ")])),_:2},1032,["onClick"])]),_:1}))]),_:1},8,["data"])),[[Q,g.value.length!==0]]),a.readonly?$("",!0):j((f(),b(C,{key:1,type:"primary",size:"default",plain:"",onClick:x},{default:e(()=>s[6]||(s[6]=[m(" 为指定地区设置运费模版 ")])),_:1},512)),[[Q,g.value.length===0]]),l(H,{modelValue:t(c).visible,"onUpdate:modelValue":s[1]||(s[1]=d=>t(c).visible=d),title:"选择地区",width:"800px","append-to-body":""},{footer:e(()=>[l(C,{type:"primary",onClick:L},{default:e(()=>s[7]||(s[7]=[m(" 确 定 ")])),_:1})]),default:e(()=>[l(_,{modelValue:t(c).checkList,"onUpdate:modelValue":s[0]||(s[0]=d=>t(c).checkList=d),style:{"margin-left":"50px"}},{default:e(()=>[l(r,null,{default:e(()=>[(f(!0),h(K,null,O(t(N),(d,y)=>(f(),b(U,{key:y,span:6},{default:e(()=>[l(D,{label:d.code,disabled:t(c).disableList.includes(d.code)},{default:e(()=>[m(z(d.name),1)]),_:2},1032,["label","disabled"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),we=J(Ce,[["__scopeId","data-v-1d5f3a03"]]),he={class:"freight"},Le=A({__name:"index",props:{id:{default:""}},setup(v,{expose:g}){const c=v,x=T(!1),L=le("formRef"),n=T({id:c.id,title:"",address:[],type:1,status:!0,first_step:"",first_price:"",continued_step:"",continued_price:"",infos:[]}),u=T({title:[{required:!0,message:"请输入标题",trigger:"blur"}]});te(()=>{n.value.id!==""&&k()});function k(){x.value=!0,P.detail(n.value.id).then(E=>{x.value=!1,Object.assign(n.value,E.data)})}return g({submit(){return new Promise(E=>{var o;(o=L.value)==null||o.validate(a=>{a&&(n.value.id===""?P.create(n.value).then(()=>{G.success({message:"模拟新增成功",center:!0}),E()}):P.edit(n.value).then(()=>{G.success({message:"模拟编辑成功",center:!0}),E()}))})})}}),(E,o)=>{const a=p("ElInput"),s=p("ElFormItem"),V=_e,U=p("ElRadioButton"),C=p("ElRadioGroup"),r=p("ElCol"),i=p("ElRow"),R=p("ElCard"),M=p("ElForm"),D=oe("loading");return j((f(),h("div",null,[l(M,{ref_key:"formRef",ref:L,model:t(n),rules:t(u),"label-width":"120px","label-suffix":"："},{default:e(()=>[l(s,{label:"名称",prop:"title"},{default:e(()=>[l(a,{modelValue:t(n).title,"onUpdate:modelValue":o[0]||(o[0]=_=>t(n).title=_),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),l(s,{label:"发货地址",prop:"address"},{default:e(()=>[l(V,{modelValue:t(n).address,"onUpdate:modelValue":o[1]||(o[1]=_=>t(n).address=_),format:"name"},null,8,["modelValue"])]),_:1}),l(s,{label:"计价方式"},{default:e(()=>[l(C,{modelValue:t(n).type,"onUpdate:modelValue":o[2]||(o[2]=_=>t(n).type=_)},{default:e(()=>[l(U,{label:1},{default:e(()=>o[9]||(o[9]=[m(" 按件数 ")])),_:1}),l(U,{label:2},{default:e(()=>o[10]||(o[10]=[m(" 按重量 ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"运费模版"},{default:e(()=>[W("div",he,[l(R,{shadow:"never"},{header:e(()=>o[11]||(o[11]=[m(" 默认运费 ")])),default:e(()=>[l(i,{gutter:20},{default:e(()=>[l(r,{md:6},{default:e(()=>[l(a,{modelValue:t(n).first_step,"onUpdate:modelValue":o[3]||(o[3]=_=>t(n).first_step=_),size:"small"},{prepend:e(()=>[m(z(t(n).type===1?"首件":"首重"),1)]),append:e(()=>[m(z(t(n).type===1?"件":"kg"),1)]),_:1},8,["modelValue"])]),_:1}),l(r,{md:6},{default:e(()=>[l(a,{modelValue:t(n).first_price,"onUpdate:modelValue":o[4]||(o[4]=_=>t(n).first_price=_),size:"small"},{prepend:e(()=>o[12]||(o[12]=[m(" 首费 ")])),append:e(()=>o[13]||(o[13]=[m(" 元 ")])),_:1},8,["modelValue"])]),_:1}),l(r,{md:6},{default:e(()=>[l(a,{modelValue:t(n).continued_step,"onUpdate:modelValue":o[5]||(o[5]=_=>t(n).continued_step=_),size:"small"},{prepend:e(()=>[m(z(t(n).type===1?"续件":"续重"),1)]),append:e(()=>[m(z(t(n).type===1?"件":"kg"),1)]),_:1},8,["modelValue"])]),_:1}),l(r,{md:6},{default:e(()=>[l(a,{modelValue:t(n).continued_price,"onUpdate:modelValue":o[6]||(o[6]=_=>t(n).continued_price=_),size:"small"},{prepend:e(()=>o[14]||(o[14]=[m(" 续费 ")])),append:e(()=>o[15]||(o[15]=[m(" 元 ")])),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(i,null,{default:e(()=>[l(r,{span:24},{default:e(()=>[l(we,{modelValue:t(n).infos,"onUpdate:modelValue":o[7]||(o[7]=_=>t(n).infos=_),type:t(n).type},null,8,["modelValue","type"])]),_:1})]),_:1})])]),_:1}),l(s,{label:"是否启用"},{default:e(()=>[l(C,{modelValue:t(n).status,"onUpdate:modelValue":o[8]||(o[8]=_=>t(n).status=_)},{default:e(()=>[l(U,{label:!0},{default:e(()=>o[16]||(o[16]=[m(" 启用 ")])),_:1}),l(U,{label:!1},{default:e(()=>o[17]||(o[17]=[m(" 停用 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])),[[D,t(x)]])}}}),Z=J(Le,[["__scopeId","data-v-dfb98fe0"]]),Ue={class:"buttons"},ze=A({__name:"index",props:q({mode:{},id:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:q(["success"],["update:modelValue"]),setup(v,{emit:g}){const c=v,x=g,L=ee(v,"modelValue"),n=le("formRef"),u=pe(()=>c.id===""?"新增运费模板":"编辑运费模板");function k(){var o;(o=n.value)==null||o.submit().then(()=>{x("success"),E()})}function E(){L.value=!1}return(o,a)=>{const s=p("ElButton"),V=p("ElDialog"),U=p("ElDrawer");return f(),h("div",null,[c.mode==="dialog"?(f(),b(V,{key:0,modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=C=>L.value=C),title:t(u),width:"1000px","close-on-click-modal":!1,"append-to-body":"","destroy-on-close":""},{footer:e(()=>[l(s,{onClick:E},{default:e(()=>a[2]||(a[2]=[m(" 取消 ")])),_:1}),l(s,{type:"primary",onClick:k},{default:e(()=>a[3]||(a[3]=[m(" 确定 ")])),_:1})]),default:e(()=>[l(Z,X({ref_key:"formRef",ref:n},o.$props),null,16)]),_:1},8,["modelValue","title"])):c.mode==="drawer"?(f(),b(U,{key:1,modelValue:L.value,"onUpdate:modelValue":a[1]||(a[1]=C=>L.value=C),title:t(u),size:"1000px","close-on-click-modal":!1,"destroy-on-close":""},{default:e(()=>[l(Z,X({ref_key:"formRef",ref:n},o.$props),null,16),W("div",Ue,[l(s,{onClick:E},{default:e(()=>a[4]||(a[4]=[m(" 取消 ")])),_:1}),l(s,{type:"primary",onClick:k},{default:e(()=>a[5]||(a[5]=[m(" 确定 ")])),_:1})])]),_:1},8,["modelValue","title"])):$("",!0)])}}}),xe=A({__name:"index",setup(v){const{pagination:g,getParams:c,onSizeChange:x,onCurrentChange:L,onSortChange:n}=ge(),u=T({loading:!1,tableAutoHeight:!1,formMode:"dialog",formModeProps:{visible:!1,id:""},search:{title:""},batch:{enable:!1,selectionDataList:[]},dataList:[]});te(()=>{k()});function k(){u.value.loading=!0;const r={...c(),...u.value.search.title&&{title:u.value.search.title}};P.list(r).then(i=>{u.value.loading=!1,u.value.dataList=i.data.list,g.value.total=i.data.total})}function E(r){x(r).then(()=>k())}function o(r=1){L(r).then(()=>k())}function a({prop:r,order:i}){n(r,i).then(()=>k())}function s(){u.value.formModeProps.id="",u.value.formModeProps.visible=!0}function V(r){u.value.formModeProps.id=r.id,u.value.formModeProps.visible=!0}function U(r){Y.confirm(`确认删除「${r.title}」吗？`,"确认信息").then(()=>{P.delete(r.id).then(()=>{k(),G.success({message:"模拟删除成功",center:!0})})}).catch(()=>{})}function C(r){return new Promise(i=>{Y.confirm(`确认${r.status?"停用":"启用"}「${r.title}」运费模版吗？`,"确认信息").then(()=>{r.statusLoading=!0,P.changeStatus({id:r.id,status:!r.status}).then(()=>(r.statusLoading=!1,G.success({message:`模拟${r.status?"停用":"启用"}成功`,center:!0}),i(!0))).catch(()=>(r.statusLoading=!1,i(!1)))}).catch(()=>i(!1))})}return(r,i)=>{const R=p("ElInput"),M=p("ElFormItem"),D=ce,_=p("ElButton"),H=p("ElForm"),d=me,y=p("ElDivider"),B=p("ElSpace"),F=p("ElTableColumn"),ae=p("ElSwitch"),ne=p("ElTable"),se=p("ElPagination"),ie=re,de=oe("loading");return f(),h("div",null,[l(ie,null,{default:e(()=>[l(d,{"show-toggle":!1},{default:e(({fold:w,toggle:I})=>[l(H,{model:t(u).search,size:"default","label-width":"100px","inline-message":"",inline:"",class:"search-form"},{default:e(()=>[l(M,{label:"模版名称"},{default:e(()=>[l(R,{modelValue:t(u).search.title,"onUpdate:modelValue":i[0]||(i[0]=ue=>t(u).search.title=ue),placeholder:"请输入模版名称，支持模糊查询",clearable:"",onKeydown:fe(k,["enter"]),onClear:k},null,8,["modelValue"])]),_:1}),l(M,null,{default:e(()=>[l(_,{type:"primary",onClick:k},{icon:e(()=>[l(D,{name:"i-ep:search"})]),default:e(()=>[i[3]||(i[3]=m(" 筛选 "))]),_:1}),l(_,{link:"",disabled:"",onClick:I},{icon:e(()=>[l(D,{name:w?"i-ep:caret-bottom":"i-ep:caret-top"},null,8,["name"])]),default:e(()=>[m(" "+z(w?"展开":"收起"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["model"])]),_:1}),l(y,{"border-style":"dashed"}),l(B,{wrap:""},{default:e(()=>[l(_,{type:"primary",size:"default",onClick:s},{icon:e(()=>[l(D,{name:"i-ep:plus"})]),default:e(()=>[i[4]||(i[4]=m(" 新增运费模版 "))]),_:1}),t(u).batch.enable?(f(),b(_,{key:0,size:"default",disabled:!t(u).batch.selectionDataList.length},{default:e(()=>i[5]||(i[5]=[m(" 批量操作 ")])),_:1},8,["disabled"])):$("",!0)]),_:1}),j((f(),b(ne,{class:"my-4",data:t(u).dataList,stripe:"","highlight-current-row":"",border:"",onSortChange:a,onSelectionChange:i[1]||(i[1]=w=>t(u).batch.selectionDataList=w)},{default:e(()=>[t(u).batch.enable?(f(),b(F,{key:0,type:"selection",width:"40"})):$("",!0),l(F,{prop:"title",label:"模版名称"}),l(F,{label:"开启状态",width:"100",align:"center"},{default:e(w=>[l(ae,{modelValue:w.row.status,"onUpdate:modelValue":I=>w.row.status=I,loading:w.row.statusLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>C(w.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),l(F,{label:"操作",width:"250",align:"center"},{default:e(w=>[l(_,{type:"primary",size:"small",plain:"",onClick:I=>V(w.row)},{default:e(()=>i[6]||(i[6]=[m(" 编辑 ")])),_:2},1032,["onClick"]),l(_,{type:"danger",size:"small",plain:"",onClick:I=>U(w.row)},{default:e(()=>i[7]||(i[7]=[m(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[de,t(u).loading]]),l(se,{"current-page":t(g).page,total:t(g).total,"page-size":t(g).size,"page-sizes":t(g).sizes,layout:t(g).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:E,onCurrentChange:o},null,8,["current-page","total","page-size","page-sizes","layout"])]),_:1}),t(u).formMode==="dialog"||t(u).formMode==="drawer"?(f(),b(ze,{key:0,id:t(u).formModeProps.id,modelValue:t(u).formModeProps.visible,"onUpdate:modelValue":i[2]||(i[2]=w=>t(u).formModeProps.visible=w),mode:t(u).formMode,onSuccess:k},null,8,["id","modelValue","mode"])):$("",!0)])}}}),Be=J(xe,[["__scopeId","data-v-d05e4f2d"]]);export{Be as default};
